<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>

<p-toolbar styleClass="mb-6">
    <ng-template #start>
        <div class="flex flex-wrap gap-2">
            <p-button icon="pi pi-plus" raised label="New" (onClick)="openLocationDialog()" />
        </div>
    </ng-template>

    <ng-template #end>
        <p-button label="Export" icon="pi pi-upload" severity="secondary" />
    </ng-template>
</p-toolbar>
<p-card>
    <app-table [data]="locations" [headers]="tableColumns" [showActions]="true" (edit)="editLocation($event)"
        (delete)="deleteLocation($event)"></app-table>
</p-card>


<!-- here is the dialog needed to add a new service-->
<p-dialog [(visible)]="isLocationDialog" [header]="isEditService ? 'Edit Location' : 'Add New Location'" [modal]="true"
    [closable]="true" [dismissableMask]="true" [style]="{ width: '90vw', maxWidth: '600px' }">
    <ng-template pTemplate="content">
        <form [formGroup]="addLocationForm" class="mt-4">
            <div class="row g-3 mb-3">
                <div class="col-12 col-md-6">
                    <label for="name">Location Name (English)</label>
                    <input type="text" id="name" class="form-control" formControlName="nameEN"
                        [ngClass]="{ 'is-invalid': addLocationForm.get('nameEN')?.invalid && addLocationForm.get('nameEN')?.touched }">
                    <div *ngIf="addLocationForm.get('nameEN')?.errors && addLocationForm.get('nameEN')?.touched"
                        class="invalid-feedback">
                        <div *ngIf="addLocationForm.get('nameEN')?.errors?.['required']">Name (English) is required.
                        </div>
                        <div *ngIf="addLocationForm.get('nameEN')?.errors?.['pattern']">Only English letters are
                            allowed.
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <label for="name">Location Name (Arabic)</label>
                    <input type="text" id="name" class="form-control" formControlName="nameAR"
                        [ngClass]="{ 'is-invalid': addLocationForm.get('nameAR')?.invalid && addLocationForm.get('nameEN')?.touched }">
                    <div *ngIf="addLocationForm.get('nameAR')?.errors && addLocationForm.get('nameAR')?.touched"
                        class="invalid-feedback">
                        <div *ngIf="addLocationForm.get('nameAR')?.errors?.['required']">Name (Arabic) is required.
                        </div>
                        <div *ngIf="addLocationForm.get('nameAR')?.errors?.['pattern']">Only Arabic letters are allowed.
                        </div>
                    </div>
                </div>
            </div>

            <div class="row g-3">
                <div class="col-12 col-md-6">
                    <label for="addressAr">Location Address (Arabic)</label>
                    <input type="text" id="name" class="form-control" formControlName="addressAr"
                        [ngClass]="{ 'is-invalid': addLocationForm.get('addressAr')?.invalid && addLocationForm.get('addressAr')?.touched }">
                    <div *ngIf="addLocationForm.get('addressAr')?.errors && addLocationForm.get('addressAr')?.touched"
                        class="invalid-feedback">
                        <div *ngIf="addLocationForm.get('addressAr')?.errors?.['required']">Location address is
                            required.
                        </div>
                        <div *ngIf="addLocationForm.get('addressAr')?.errors?.['pattern']">Only Arabic letters, numbers,
                            and symbols (,.-) are allowed.</div>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <label for="addressEn">Location Address (English)</label>
                    <input type="text" id="addressEn" class="form-control" formControlName="addressEn"
                        [ngClass]="{ 'is-invalid': addLocationForm.get('addressEn')?.invalid && addLocationForm.get('addressEn')?.touched }">
                    <div *ngIf="addLocationForm.get('addressEn')?.errors && addLocationForm.get('addressEn')?.touched"
                        class="invalid-feedback">
                        <div *ngIf="addLocationForm.get('addressEn')?.errors?.['required']">Location address is
                            required.</div>
                        <div *ngIf="addLocationForm.get('addressEn')?.errors?.['pattern']">Only English letters,
                            numbers, and symbols (,.-) are allowed.</div>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <label for="name">Location Phone</label>
                    <input type="text" id="phone" class="form-control" formControlName="phoneNumber"
                        [ngClass]="{ 'is-invalid': addLocationForm.get('phoneNumber')?.invalid && addLocationForm.get('phoneNumber')?.touched }">
                    <div *ngIf="addLocationForm.get('phoneNumber')?.errors && addLocationForm.get('phoneNumber')?.touched"
                        class="invalid-feedback">
                        <div *ngIf="addLocationForm.get('phoneNumber')?.errors?.['required']">Phone number is required.
                        </div>
                        <div *ngIf="addLocationForm.get('phoneNumber')?.errors?.['phoneNumber']">Only numbers are
                            allowed.
                        </div>
                    </div>

                </div>
            </div>
        </form>
    </ng-template>

    <ng-template pTemplate="footer">
        <div class="flex flex-col gap-2 md:flex-row md:justify-end md:gap-4 w-full px-2 py-2">
            <p-button label="Cancel" [text]="true" severity="danger" (click)="hideDialog()" class="w-full md:w-auto" />
            <p-button label="Save" [outlined]="true" severity="success" (click)="addNewLocation()"
                class="w-full md:w-auto" />
        </div>
    </ng-template>

</p-dialog>